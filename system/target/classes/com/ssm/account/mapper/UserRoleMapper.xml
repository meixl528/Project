<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTDMapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssm.account.mapper.UserRoleMapper">
	<!-- <cache type="com.ssm.util.LoggingRedisCache"></cache> -->
	<resultMap id="BaseResultMap" type="com.ssm.account.dto.UserRole" extends="com.ssm.mapper.BaseMapper.BaseResultMap">
		<result column="id" property="id"/>
		<result column="user_id" property="userId"/>
		<result column="role_id" property="roleId"/>
		
		<result column="role_code" property="roleCode"/>
		<result column="role_name" property="roleName"/>
		<result column="description" property="description"/>
	</resultMap>
	
	<select id="selectUserRoles" resultMap="BaseResultMap" parameterType="com.ssm.account.dto.UserRole">
		SELECT 
			tr.role_code,
			tr.role_name,
			tr.description,
			tr.role_Id
		FROM tb_role tr
		<where>
			tr.role_id IN (SELECT role_id FROM tb_user_role WHERE user_id = #{userId})
			<if test="roleName !=null and roleName !=''">
				t.roleName like #{roleName}
			</if>
		</where>
	</select>
</mapper>