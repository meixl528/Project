<#include "../../include/header.html"><script type="text/javascript">    var viewModel = kendo.observable({        model: {},        createFunction: function () {            $('#Grid').data('kendoGrid').addRow();        },        saveFunction: function () {            $('#Grid').data('kendoGrid').saveChanges();        },        queryResource: function (e) {            $('#Grid').data('kendoGrid').dataSource.page(1);        }    });</script><body><div id="page-content">    <div class="pull-left" id="toolbar-btn" style="padding-bottom:10px;">        <span class="btn btn-primary k-grid-add" style="float:left; margin-right:5px;" onclick="lineEdit(0)"><i class="fa fa-plus-square" style="margin-right:3px;"></i><@spring.message "hap.new"/></span>        <span class="btn btn-success k-grid-save-changes" data-bind="click:saveFunction" style="float:left;margin-right:5px;"><@spring.message "hap.save"/></span>        <span onclick="deleteData()" class="btn btn-danger" style="float:left;"><@spring.message "hap.delete"/></span>    </div>    <script>kendo.bind($('#toolbar-btn'), viewModel);</script>    <div class="pull-right" id="query-form" style="padding-bottom:10px;">            <input type="text" data-role="maskedtextbox" style="float:left;width:150px;margin-right:5px;" placeholder='<@spring.message "wg.fnd.style_template.template_code"/>'                   data-bind="value:model.templateCode" class="k-textbox">            <input type="text" data-role="maskedtextbox" style="float:left;width:150px;margin-right:5px;" placeholder='<@spring.message "wg.fnd.style_template.template_name"/>'                   data-bind="value:model.templateName" class="k-textbox">        <span class="btn btn-primary" style="float:left;width:70px" data-bind="click:queryResource" type="submit"><@spring.message "hap.query"/></span>        <div style="clear:both"></div>    </div>    <script>kendo.bind($('#query-form'), viewModel);</script>    <div style="clear:both">        <div id="Grid"></div>    </div></div><div id="lineDialog"></div>
<script type="text/javascript">    var BaseUrl = _basePath;
    dataSource = new kendo.data.DataSource({        transport: {            read: {                url: BaseUrl + "/fnd/styleTemplate/query",                type: "POST",                dataType: "json"            },            update: {                url: BaseUrl + "/fnd/styleTemplate/submit",                type: "POST",                contentType: "application/json"            },            destroy: {                url: BaseUrl + "/fnd/styleTemplate/remove",                type: "POST",                contentType: "application/json"            },            create: {                url: BaseUrl + "/fnd/styleTemplate/submit",                type: "POST",                contentType: "application/json"            },
            parameterMap: function (options, type) {                if (type !== "read" && options.models) {                    var datas = Hap.prepareSubmitParameter(options, type)                    return kendo.stringify(datas);                } else if (type === "read") {                    return Hap.prepareQueryParameter(viewModel.model.toJSON(), options)                }            }        },        batch: true,        serverPaging: true,        pageSize: 10,        schema: {            data: 'rows',            total: 'total',            model: {                id: "templateId",                fields: {                	isHorizontal: {                        defaultValue: 'Y',                        type: 'boolean',                        checkedValue: 'Y',                        uncheckedValue: 'N'                    },                    enabledFlag: {                        defaultValue: 'Y',                        type: 'boolean',                        checkedValue: 'Y',                        uncheckedValue: 'N'                    },                }            }        }    });
    $("#Grid").kendoGrid({        dataSource: dataSource,        height: '100%',        resizable: true,        scrollable: true,        navigatable: false,        selectable: 'multiple, rowbox',        pageable: {            pageSizes: [5, 10, 20, 50],            refresh: true,            buttonCount: 5        },
        columns: [                    {                field: "templateCode",                title: '<@spring.message "wg.fnd.style_template.template_code"/>',                width: 80,                headerAttributes: {                    "class": "table-header-cell",                    style: "text-align: center"                },                attributes: {style: "text-align:center"}            },                    {                field: "templateName",                title: '<@spring.message "wg.fnd.style_template.template_name"/>',                width: 200,                headerAttributes: {                    "class": "table-header-cell",                    style: "text-align: center"                },                attributes: {style: "text-align:center"}            },            {                field: "isHorizontal",                title: '<@spring.message "wg.fnd.style_template.is_horizontal"/>',                width: 60,                headerAttributes: {                    "class": "table-header-cell",                    style: "text-align: center"                },                attributes: {style: "text-align:center"}            },                    {                field: "enabledFlag",                title: '<@spring.message "hap.enableflag"/>',                width: 60,                headerAttributes: {                    "class": "table-header-cell",                    style: "text-align: center"                },                attributes: {style: "text-align:center"}
            },            {                title: '<@spring.message "hap.action"/>',                headerAttributes: {                    "class": "table-header-cell",                    style: "text-align: center"                },                attributes: {style: "text-align:center"},                template: function (item) {                    return '<a class="k-button k-button-icontext k-grid-edit" title=<@spring.message "hap.edit"/> href="#">' + '<span onclick="lineEdit(' + item.templateId + ')" class="fa  fa-pencil-square-o"></span></a>'                            + '<a class="k-button k-button-icontext k-grid-delete" title=<@spring.message "hap.delete"/> href="#">' + '<span onclick="deleteRowData(' + item.templateId+')" class="fa fa-times"></span></a>'                },                width: "80px"            }        ],        editable: false    });        /*打开页面管理对话框*/    window.lineEdit = function (id) {        var url = '${base.contextPath}/fnd/style_template/style_template_edit.html?templateId=' + id;        var dialog = $("#lineDialog").kendoWindow({            actions: ["Maximize", "Minimize", "Close"],            width: '80%',            height:'85%',            title: "<@spring.message 'wg.fnd.style_template.template_content'/>",            content: url,            iframe: true,            visible: false,            modal: true,            close: function () {                $("#dialog").empty();            }        }).data("kendoWindow");        dialog.center().open();    };        //操作，删除行信息    function deleteRowData(id) {        kendo.ui.showConfirmDialog({            title: $l('hap.tip.info'),            message: $l('hap.tip.delete_confirm')        }).done(function (event) {            if (event.button == 'OK') {                $.ajax({                    async: false,                    type: 'post',                    dataType: "json",                    contentType: "application/json",                    url: '${base.contextPath}/fnd/styleTemplate/removeRow?templateId=' + id,                    success: function (args) {                        $('#Grid').data('kendoGrid').dataSource.page(1);                        kendo.ui.showInfoDialog({                            title: $l('hap.tip.info'),                            message: $l('hap.mesg_delete')                        })                    }                });            }        })    }
    function deleteData() {        Hap.deleteGridSelection({            grid: $('#Grid')        });    }    Hap.autoResizeGrid("#Grid");</script></body></html>