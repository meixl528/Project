<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTDMapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssm.account.mapper.UserMapper">
	<!-- <cache type="com.ssm.util.LoggingRedisCache"></cache> -->
	<resultMap id="BaseResultMap" type="com.ssm.account.dto.User" extends="com.ssm.mapper.BaseMapper.BaseResultMap">
		<result column="id" property="id" />
        <result column="name" property="name" />
        <result column="pass" property="pass" />
        <result column="email" property="email" />
        <result column="telephone" property="telephone" />
        <result column="actv_from" property="actvFrom" />
        <result column="actv_to" property="actvTo" />
        <result column="status" property="status" />
        <result column="address" property="address" />
	
	</resultMap>
	
	<select id="getUser" resultMap="BaseResultMap" parameterType="com.ssm.account.dto.User">
		select * from tb_user
		<where>
			name = #{name}
			and pass = #{pass}
		</where>
	</select>
	
	<insert id="addUser" parameterType="com.ssm.account.dto.User">
		insert into tb_user 
		(name,pass,email,actv_From,actv_To,status,telephone,address,description) 
		values 
		(#{name},#{pass},#{email},#{actvFrom},#{actvTo},#{status},#{telephone},#{address},#{description})
	</insert>
	
	<delete id="removeUserById" parameterType="Long">
		delete from tb_user where id = #{id}
	</delete>
	
	<update id="updateUser" parameterType="com.ssm.account.dto.User">
		update tb_user 
		<set>
			<if test="name!=null and name!='' ">
				name=#{name},
			</if>
			<if test="pass!=null and pass!='' ">
				pass=#{pass},
			</if>
			<if test="email!=null and email!='' ">
				email=#{email},
			</if>
			<if test="actvFrom!=null ">
				Actv_From=#{actvFrom},
			</if>
			<if test="actvTo!=null ">
				Actv_To=#{actvTo},
			</if>
			<if test="status!=null and status!='' ">
				status=#{status},
			</if>
			<if test="telephone!=null and telephone!='' ">
				telephone=#{telephone},
			</if>
			<if test="address!=null and address!='' ">
				address=#{address},
			</if>
			<if test="description!=null and description!='' ">
				description=#{description}
			</if>
		</set>
		<where>
			id=#{id}
		</where>
	</update>
	
	<select id="selectByUserName" resultType="com.ssm.account.dto.User" parameterType="java.lang.String">
        select
        	id,name,pass,status
        from tb_user
       <where>
       		name = #{name,jdbcType=VARCHAR}
       </where> 
    </select>
</mapper>